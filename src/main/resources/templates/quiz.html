<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments/layout :: head('クイズ回答')}"></head>

<body th:replace="~{fragments/layout :: layout(~{::mainContent})}">
    <div th:fragment="mainContent"
        class="relative flex h-full min-h-screen w-full max-w-md flex-col overflow-hidden bg-bg-base mx-auto shadow-2xl antialiased">
        <!-- Header -->
        <div class="px-6 pt-10 pb-4 flex items-center justify-between z-10">
            <a th:href="@{/quiz/settings}"
                class="flex items-center justify-center w-12 h-12 rounded-full neu-raised hover:neu-pressed active:neu-pressed text-text-main group transition-all">
                <span
                    class="material-symbols-outlined font-bold text-[22px] group-hover:text-primary transition-colors">close</span>
            </a>
            <h1 class="text-text-main font-bold text-lg tracking-wide font-japanese">クイズ実行中</h1>
            <div
                class="flex items-center gap-2 px-5 h-10 rounded-full neu-pressed text-primary font-bold text-sm tracking-wide">
                <span th:text="${quizSession.currentQuestionNumber}">1</span>
                <span class="text-text-sub font-normal opacity-50">/</span>
                <span class="text-text-sub" th:text="${quizSession.totalQuestions}">10</span>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="px-8 py-2">
            <div class="flex justify-between items-end mb-3">
                <span class="text-xs font-semibold text-text-sub tracking-wider pl-1 font-japanese">進捗状況</span>
                <span class="text-xs font-bold text-primary"
                    th:text="${(quizSession.currentQuestionNumber * 100) / quizSession.totalQuestions} + '%'">0%</span>
            </div>
            <div class="h-3 w-full rounded-full neu-pressed p-[2px]">
                <div class="h-full rounded-full bg-primary shadow-[2px_2px_4px_rgba(166,139,119,0.3)] transition-all duration-500"
                    th:style="'width: ' + ${(quizSession.currentQuestionNumber * 100) / quizSession.totalQuestions} + '%'">
                </div>
            </div>
        </div>

        <!-- Question Card -->
        <div class="flex-1 flex flex-col px-6 pb-6 gap-6 overflow-y-auto">
            <div
                class="w-full relative rounded-3xl bg-bg-base shadow-neu-floating p-8 flex flex-col items-center text-center gap-2 mt-8 mb-2 border border-white/40">
                <div
                    class="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 w-20 h-20 rounded-full neu-raised flex items-center justify-center z-10 border-4 border-bg-base">
                    <span class="material-symbols-outlined text-4xl text-primary drop-shadow-sm">school</span>
                </div>
                <div class="pt-8 w-full flex flex-col items-center">
                    <p
                        class="text-text-sub text-xs font-medium tracking-widest mb-3 opacity-80 uppercase font-japanese">
                        意味</p>
                    <h2 class="text-[2.2rem] font-bold text-text-main mb-6 tracking-tight drop-shadow-sm leading-tight"
                        th:text="${word.definition}">意味内容を表示します</h2>
                    <div class="w-full border-t border-text-sub/10 my-2"></div>
                    <p class="mt-4 text-text-sub text-sm font-light leading-relaxed max-w-[90%] opacity-90 font-japanese"
                        th:if="${word.exampleSentence != null}" th:text="${word.exampleSentence}">
                        例文がここに表示されます。
                    </p>
                </div>
            </div>

            <!-- Answer Input -->
            <form th:action="@{/quiz/answer}" method="post" class="flex flex-col gap-4 mt-2">
                <label class="text-sm font-semibold text-text-sub ml-2 block mb-1 font-japanese"
                    for="answer">回答を入力</label>
                <div class="relative">
                    <input
                        class="w-full p-5 rounded-2xl neu-pressed text-lg text-text-main placeholder:text-text-sub/50 font-medium tracking-wide focus:ring-0 focus:outline-none border-none"
                        id="answer" name="answer" placeholder="答えを入力..." type="text" required autofocus
                        autocomplete="off" />
                    <span
                        class="absolute right-5 top-1/2 -translate-y-1/2 material-symbols-outlined text-text-sub/40">edit</span>
                </div>

                <!-- Submit Button -->
                <div class="p-6 pt-8 bg-bg-base pb-10 sticky bottom-0 z-20">
                    <button type="submit"
                        class="w-full py-4 rounded-2xl neu-action-btn text-lg tracking-wide flex items-center justify-center gap-2 hover:bg-opacity-90 transition-all">
                        <span>回答を送信</span>
                        <span class="material-symbols-outlined text-[24px]">send</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script th:inline="javascript">
        const activePage = 'quiz';
        const showNav = false;
    </script>
</body>

</html>