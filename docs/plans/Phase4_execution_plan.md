# Phase 4 実行計画書: クイズ機能の実装

本書は、MVP実行計画書の「Phase4: クイズ機能の実装」を詳細化した作業手順書です。学習のコアとなる一問一答機能を開発します。

## 1. 出題機能の基盤作成 (ロジック実装)

### 1-1. QuizService の作成
- [x] `com.vocabulary.vocab_spring.service.QuizService` クラスの作成
  - `@Service` アノテーションを付与
  - `WordRepository` をDI（依存性注入）し、データベースから単語を取得できるようにする

### 1-2. 問題取得ロジックの実装
- [x] **ランダム出題メソッドの実装**
  - 引数：対象の `User`
  - 内容：ユーザーが登録した全単語の中からランダムに1件を取得する
- [x] **カテゴリ指定出題メソッドの実装**
  - 引数：対象の `User`、指定された `categoryId`
  - 内容：特定のカテゴリに属する単語のみを対象に、ランダムに1件を取得する

## 2. クイズ画面の実装

### 2-1. QuizController の設定 (出題側)
- [x] `com.vocabulary.vocab_spring.controller.QuizController` クラスの作成
- [x] `GET /quiz/settings` （または `/quiz`）：クイズ設定画面の表示
  - 全出題にするか、特定のカテゴリから出題するかを選択できるUI用の通信
  - **新規追加**: 出題数（5問または10問）を選択できるUIの実装
- [x] クイズのセッション状態（現在の問題数、設定された出題数、正答数など）を保持する仕組み (Session属性などの利用)
- [x] `GET /quiz/start`：出題画面 (`quiz.html`) を表示
  - `QuizService` を呼び出して問題となる単語情報を取得し、ビュー（HTML）へ渡す。何問目かも表示する

### 2-2. クイズ出題画面 (quiz.html) の作成
- [x] `src/main/resources/templates/quiz.html` の作成
- [x] 出題内容（日本語の意味、または英単語）を画面に表示
- [x] ユーザーが解答を入力するためのテキストボックスと、「回答する」ボタンのフォームを作成

## 3. 正誤判定と結果表示

### 3-1. 正誤判定ロジックの実装
- [x] `POST /quiz/answer`：解答を送信するエンドポイントを `QuizController` に追加
- [x] 送信された解答と、正解の単語の読み・綴りを比較するロジック（完全一致）の実装
  - 例: 大文字・小文字のぶれを吸収する処理（任意・推奨）

### 3-2. クイズ結果画面 (quiz_result.html) の作成
- [x] `src/main/resources/templates/quiz_result.html` の作成
- [x] 各問題の判定結果（「正解！」または「不正解…」）の表示
- [x] 正解の単語と、ユーザーが入力した解答の対比表示
- [x] 現在の出題数に応じたボタンの表示制御
  - 次の問題がある場合：「次の問題へ」ボタンを表示
  - 指定した出題数（5問または10問）に達した場合：「クイズ結果のまとめへ」等の終了を示すボタンを表示（※Phase5実装までの仮置き）

### 3-3. クイズ完了まとめ画面の概念
- 5問または10問の区切りが完了したあとに、全体の結果をまとめて表示し、AIからのコメント(Phase5)を受け取るプレースホルダーとなる画面を用意する。（または遷移先の確保）

## 4. 動作確認・テスト

### 4-1. 出題機能の確認
- [x] 単語が複数登録されている状態で、ランダムに単語が出題されることを確認
- [x] 指定したカテゴリの単語のみ出題され、他のカテゴリが混じらないことを確認

### 4-2. 正誤判定の確認
- [x] 正しい解答を入力した場合、正解画面に遷移することを確認
- [x] 誤った解答を入力した場合、不正解であることを示し、正しい単語が画面に提示されることを確認
