<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments/head :: head('VocabularySpring - 単語帳一覧')}"></head>
<style>
    .hide-scrollbar::-webkit-scrollbar {
        display: none;
    }

    .hide-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
    }

    body {
        min-height: max(884px, 100dvh);
        background-color: #F5F3F0;
    }

    /* Custom details marker hide */
    details>summary::-webkit-details-marker {
        display: none;
    }
</style>

<body class="bg-background-light font-body text-text-main antialiased selection:bg-primary selection:text-white">
    <div
        class="relative flex min-h-screen w-full flex-col max-w-md mx-auto bg-background-light overflow-hidden shadow-2xl">

        <header class="flex items-start justify-between px-6 pt-12 pb-4 z-10 bg-background-light">
            <div class="flex flex-col">
                <h1 class="text-2xl font-bold tracking-tight text-text-main font-display">単語帳一覧</h1>
            </div>
            <div class="flex items-center gap-3">
                <a href="/words/new"
                    class="flex items-center justify-center w-10 h-10 rounded-full bg-surface-light shadow-neu-btn text-text-main active:shadow-neu-pressed transition-all duration-200 active:scale-95">
                    <span class="material-symbols-outlined font-bold text-[20px]">add</span>
                </a>
            </div>
        </header>

        <!-- Grouped lists -->
        <div class="flex-1 overflow-y-auto px-6 pb-32 hide-scrollbar space-y-4 pt-4">

            <div th:if="${!wordsByCategory.isEmpty()}">
                <!-- Categories -->
                <details class="group mb-8" th:each="entry : ${wordsByCategory}" open>
                    <summary
                        class="flex items-center justify-between p-2 cursor-pointer list-none outline-none select-none">
                        <div class="flex items-center gap-3">
                            <span class="text-lg font-bold text-text-main font-display"
                                th:text="${entry.key}">Category</span>
                            <span
                                class="px-3 py-1 rounded-full bg-primary text-white text-[10px] font-bold shadow-neu-flat-soft tracking-wider"
                                th:text="${#lists.size(entry.value)} + ' 語'">X語</span>
                        </div>
                        <span
                            class="material-symbols-outlined text-text-muted transition-transform group-open:rotate-90">chevron_right</span>
                    </summary>

                    <div class="flex flex-col gap-2 mt-2 px-1">
                        <div th:each="word : ${entry.value}"
                            class="group/card flex items-center justify-between p-3 rounded-2xl bg-surface-light shadow-neu-flat-soft active:shadow-neu-pressed transition-all overflow-hidden relative">
                            <!-- Clickable area for editing -->
                            <a th:href="@{/words/edit/{id}(id=${word.id})}" class="flex-1 min-w-0 pr-4 outline-none"
                                style="text-decoration:none;">
                                <div class="flex flex-col w-full">
                                    <div class="flex flex-col gap-1 w-full mb-1">
                                        <h3 class="text-text-main text-lg font-bold font-display tracking-tight group-hover/card:text-primary transition-colors"
                                            th:text="${word.term}">Term</h3>
                                        <span class="text-text-muted text-sm font-medium whitespace-normal"
                                            th:text="${word.definition}">Definition</span>
                                    </div>
                                    <p class="text-[11px] text-text-muted/80 leading-snug w-full whitespace-normal"
                                        th:text="${word.exampleSentence != null and word.exampleSentence != '' ? word.exampleSentence : '例文なし'}">
                                        Example sentence</p>
                                </div>
                            </a>

                            <!-- Delete Form -->
                            <form th:action="@{/words/delete/{id}(id=${word.id})}" method="post"
                                class="flex-shrink-0 z-10" onsubmit="return confirm('本当に削除しますか？');">
                                <button type="submit"
                                    class="p-2 rounded-full text-text-muted hover:text-red-500 hover:bg-white transition-all hover:shadow-neu-flat-soft flex items-center justify-center -mr-2">
                                    <span class="material-symbols-outlined text-[20px]">delete</span>
                                </button>
                            </form>
                        </div>
                    </div>
                </details>
            </div>

            <!-- Empty state -->
            <div th:if="${wordsByCategory.isEmpty()}" class="flex flex-col items-center justify-center pt-20 pb-10">
                <div
                    class="w-16 h-16 rounded-full bg-surface-light shadow-neu-pressed flex items-center justify-center text-text-muted mb-4">
                    <span class="material-symbols-outlined text-3xl">sentiment_dissatisfied</span>
                </div>
                <p class="text-text-muted font-medium text-sm">単語がまだ登録されていません。</p>
                <a href="/words/new"
                    class="mt-6 px-6 py-3 rounded-xl bg-primary text-white font-bold shadow-neu-btn active:translate-y-[2px] active:shadow-none transition-all">
                    最初の単語を追加
                </a>
            </div>

        </div>

        <div th:replace="~{fragments/bottom_nav :: bottomNav('words')}"></div>
    </div>

</body>

</html>