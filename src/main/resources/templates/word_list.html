<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments/layout :: head('単語帳')}"></head>

<body th:replace="~{fragments/layout :: layout(~{::mainContent})}">
    <div th:fragment="mainContent"
        class="relative flex h-screen w-full flex-col max-w-md mx-auto bg-bg-base overflow-hidden">
        <!-- Header -->
        <header class="flex items-start justify-between px-6 pt-12 pb-4 z-10 bg-bg-base">
            <div class="flex flex-col">
                <h1 class="text-2xl font-bold tracking-tight text-text-main font-display">単語帳</h1>
                <p class="text-xs text-text-sub mt-1 font-medium" th:text="'全 ' + ${totalWords} + ' 単語'">全 0 単語</p>
            </div>
            <div class="flex items-center gap-3">
                <!-- Filter Button (Optional) -->
                <button class="neu-icon-btn w-10 h-10 rounded-full text-text-main">
                    <span class="material-symbols-outlined font-medium text-[20px]">tune</span>
                </button>
                <!-- Add Button -->
                <a th:href="@{/words/new}" class="neu-icon-btn w-10 h-10 rounded-full text-text-main">
                    <span class="material-symbols-outlined font-bold text-[20px]">add</span>
                </a>
            </div>
        </header>

        <!-- Search Bar -->
        <div class="px-6 py-2">
            <div class="neu-pressed rounded-xl flex items-center w-full h-12 px-4 transition-all">
                <span class="material-symbols-outlined text-text-sub mr-3 text-[20px]">search</span>
                <input
                    class="w-full bg-transparent border-none focus:ring-0 text-text-main placeholder-text-sub text-sm font-medium tracking-wide"
                    placeholder="単語を検索..." type="text" />
            </div>
        </div>

        <!-- Category Filters -->
        <div class="px-6 py-4">
            <div class="flex space-x-3 overflow-x-auto hide-scrollbar pb-2 pt-1 px-1">
                <button class="flex-shrink-0 px-5 py-2 rounded-full neu-action-btn text-xs">すべて</button>
                <button th:each="entry : ${wordsByCategory}"
                    class="flex-shrink-0 px-5 py-2 rounded-full neu-raised text-text-sub font-medium text-xs hover:text-text-main transition-all">
                    <span th:text="${entry.key}">カテゴリー</span>
                </button>
            </div>
        </div>

        <!-- Word List -->
        <div class="flex-1 overflow-y-auto px-6 pb-32 hide-scrollbar space-y-4 pt-2">
            <!-- Empty Message -->
            <div th:if="${wordsByCategory.isEmpty()}" class="neu-pressed rounded-3xl p-10 text-center">
                <p class="text-text-sub text-sm">単語がまだ登録されていません。</p>
                <a th:href="@{/words/new}" class="text-primary text-xs font-bold mt-2 inline-block">＋ 最初の単語を追加しましょう</a>
            </div>

            <!-- Loop through categories and words -->
            <div th:each="entry : ${wordsByCategory}" th:remove="tag">
                <!-- Category Heading (Optional, or just show category badge on card) -->
                <h2 class="text-xs font-bold text-text-sub uppercase tracking-widest mt-6 mb-2 ml-2"
                    th:text="${entry.key}">CATEGORY</h2>
                <div th:each="word : ${entry.value}"
                    class="group flex items-start justify-between p-5 rounded-2xl neu-raised active:neu-pressed transition-all cursor-pointer border border-transparent hover:scale-[1.01]">
                    <div class="flex flex-col w-full">
                        <div class="flex items-baseline gap-3 w-full mb-1">
                            <h3 class="text-text-main text-base font-bold font-display tracking-tight group-hover:text-primary transition-colors"
                                th:text="${word.term}">Term</h3>
                            <span class="text-text-sub text-xs font-medium" th:text="${word.definition}">Meaning</span>
                        </div>
                        <p class="text-[11px] text-text-sub/80 leading-snug w-[90%] truncate"
                            th:text="${word.exampleSentence}">Example sentence...</p>
                    </div>
                    <div class="flex flex-col gap-2 items-center">
                        <a th:href="@{/words/edit/{id}(id=${word.id})}" class="text-primary hover:text-primary-dark">
                            <span class="material-symbols-outlined text-[18px]">edit</span>
                        </a>
                        <form th:action="@{/words/delete/{id}(id=${word.id})}" method="post"
                            onsubmit="return confirm('本当に削除しますか？')">
                            <button type="submit" class="text-red-400 hover:text-red-500">
                                <span class="material-symbols-outlined text-[18px]">delete</span>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Pass variables to fragment -->
        <script th:inline="javascript">
            const activePage = 'words';
            const showNav = true;
        </script>
    </div>
</body>

</html>